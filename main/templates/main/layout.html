{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medad - Ù…Ø¯Ø§Ø¯</title>
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Ø±Ø§Ø¨Ø· Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    {% block head %} {% endblock %}
</head>
<body>
    <header class="header">
        {% include "main/header.html" %}
    </header>
      <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
    <div id="splash">
        <video autoplay muted playsinline>
            <source src="{% static 'video/intro.mp4' %}" type="video/mp4">
        </video>
    </div>
    <main>
        {% block body %} {% endblock %}
    </main>
    <footer class="footer">
        {% include "main/footer.html" %}
    </footer>

{% if user.is_authenticated %}
<!-- Ø§Ù„Ø²Ø± Ø§Ù„Ø¹Ø§Ø¦Ù… -->
<button id="suggestion-btn" class="floating-btn">
    <i class="fas fa-envelope"></i>
</button>
{% endif %}

<!-- Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div id="suggestion-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h3>ğŸ“© Ù…Ù‚ØªØ±Ø­ Ø¬Ø¯ÙŠØ¯</h3>
        <form method="post" action="{% url 'add_suggestion' %}">
            {% csrf_token %}
            
            <!-- Ø­Ù‚Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
            <div class="form-group">
                <label for="content">Ø§Ù„Ù…Ù‚ØªØ±Ø­ <span class="required">*</span></label>
                <textarea class="form-control" id="content" name="content" maxlength="255" required placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù‚ØªØ±Ø­Ùƒ Ù‡Ù†Ø§..."></textarea>
                <div class="char-count">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø­Ø±Ù: <span id="charCount">0</span>/255</div>
            </div>

            <div class="buttons">
                <button type="submit" class="btn btn-success"><i class="fas fa-check"></i> Ø¥Ø±Ø³Ø§Ù„</button>
                {% comment %} <button type="button" class="btn btn-secondary close"><i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡</button> {% endcomment %}
            </div>
        </form>
    </div>
</div>


    <script>
        const splash = document.getElementById("splash");
        const content = document.getElementById("content");
        const video = splash.querySelector("video");

        // Ø¹Ù†Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        video.onended = () => {
        splash.style.display = "none";
        content.classList.add("show");
        document.body.style.overflow = "auto";
        };

        setTimeout(() => {
        if (splash.style.display !== "none") {
            splash.style.display = "none";
            content.classList.add("show");
            document.body.style.overflow = "auto";
        }
        }, 2000);



        // ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
        const modal = document.getElementById("suggestion-modal");
        const btn = document.getElementById("suggestion-btn");
        const closes = document.querySelectorAll(".close");

        btn.onclick = () => modal.style.display = "block";
        closes.forEach(c => c.onclick = () => modal.style.display = "none");

        // Ø¥ØºÙ„Ø§Ù‚ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
        window.onclick = e => { if (e.target == modal) modal.style.display = "none"; }

                // Ø¹Ø¯ Ø§Ù„Ø£Ø­Ø±Ù Ù„Ù„Ù…Ù‚ØªØ±Ø­
        const contentTextarea = document.getElementById('content');
        const charCount = document.getElementById('charCount');
        
        contentTextarea.addEventListener('input', function() {
            const length = this.value.length;
            charCount.textContent = length;
            
            if (length > 240) {
                charCount.style.color = '#e74c3c';
            } else {
                charCount.style.color = '#7f8c8d';
            }
        });
        
        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡
        document.querySelector('.close').addEventListener('click', function() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŸ')) {
                window.location.href = '/'; // ØªØºÙŠÙŠØ± Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ùƒ
            }
        });
    </script>

</body>
</html>
