{% extends "main/layout.html" %}
{% load static %}

{% block head %}
<link href="{% static 'css/control_panel.css' %}" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block body %}
<div class="main-container">
    <div class="sections-wrapper">
        <div class="section-block">
            <h1 class="animated-title">برامجي</h1>
            <div class="page-container">
                {% if user_committees %}
                {% for uc in user_committees %}
                <div class="program-card reveal {{ uc.committee.get_committees_display|lower }}"
                    style="--card-index: {{ forloop.counter }}">
                    <h2 class="program-title">{{ uc.committee.title }} - اللجنة {{ uc.committee.get_committees_display }}</h2>
                    <p class="program-description">{{ uc.committee.description }}</p>
                    <div class="button-group">
                        {% if uc.committee.link %}
                            <a href="{{ uc.committee.link }}" target="_blank" rel="noopener noreferrer" class="pdf-link">
                                <span class="pdf-icon"><i class="fa-solid fa-link"></i></span>
                                <span class="pdf-text">رابط البرنامج</span>
                            </a>
                        {% endif %}

                        {% if uc.committee.pdf %}
                            <a href="{% url 'pdf_view_committe' uc.committee.id %}" target="_blank" rel="noopener noreferrer" class="pdf-link">
                                <span class="pdf-icon"><i class="fa-solid fa-file-pdf"></i></span>
                                <span class="pdf-text">عرض PDF</span>
                            </a>
                        {% else %}
                            <span class="pdf-link disabled">
                                <span class="pdf-icon"><i class="fa-solid fa-ban"></i></span>
                                <span class="pdf-text">لا يوجد ملف PDF</span>
                            </span>
                        {% endif %}

                        <form method="post" action="{% url 'toggle_committee' uc.committee.id %}">
                            {% csrf_token %}
                            <button class="program-button remove-button" type="submit">إزالة من برامجي</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="no-programs-message">
                    <i class="fa-regular fa-folder-open"></i>
                    <p>لا يوجد برامج للجان بعد. اضف برامج وتابع تقدمك</p>
                </div>
                {% endif %}

                <div class="back-button-wrapper">
                    <a href="{% url 'committees' %}" class="back-button">العودة إلى اللجان</a>
                </div>
            </div>
        </div>
    </div>

    <div class="home-back-container">
        <a href="{% url 'index' %}" class="home-back-button">العودة إلى الصفحة الرئيسية</a>
    </div>
</div>

<script>
    // Scroll reveal animation
    function reveal() {
        const reveals = document.querySelectorAll(".reveal");

        reveals.forEach((element, index) => {
            const windowHeight = window.innerHeight;
            const elementTop = element.getBoundingClientRect().top;
            const elementVisible = 150;

            if (elementTop < windowHeight - elementVisible) {
                setTimeout(() => {
                    element.classList.add("active");
                }, index * 100);
            }
        });
    }

    // Initial call and event listener
    window.addEventListener("load", reveal);
    window.addEventListener("scroll", reveal);

    // Hover animation for cards
    document.addEventListener("DOMContentLoaded", function() {
        const cards = document.querySelectorAll(".program-card");

        cards.forEach(card => {
            card.addEventListener("mouseenter", function() {
                this.style.transform = "translateY(-7px) scale(1.02)";
                this.style.zIndex = "10";
            });

            card.addEventListener("mouseleave", function() {
                this.style.transform = "translateY(0) scale(1)";
                this.style.zIndex = "1";
            });
        });
    });
</script>
{% endblock body %}